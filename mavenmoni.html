<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>锅炉检测</title>
    <script src="js/echarts.js"></script>
    <link rel="stylesheet" href="css/base.css">    
    <link rel="stylesheet" href="bootstrap/css/bootstrap-theme.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">     
    <style>
      #main{
        width: 600px;
        height:400px;
      }

      #mavenMoniChart_1{
          top: 10%;
      }
      #tablediv{
          position: absolute;
        top: 0px !important;
        overflow-x: none!important; 
        overflow-y: auto!important; 
        height: 500px!important; 
        width:65%!important;
      }
      #table_1{
    height: 100%;
    margin: none; 
   width: 100%;
    position: relative;
      }
    </style>
</head>
<body>
    <!--顶部-->
    <header class="header left" style="position: absolute; top: 0px;">
    
        <div class="left nav">
            <ul>
                <li ><i class="nav_1"></i><a href="index.html">动态可视化</a> </li>
                <li ><i class="nav_2"></i><a href="GasUse.html">燃气用量</a> </li>
                <li class="nav_active"><i class="nav_3"></i><a href="mavenmoni.html">锅炉检测</a> </li>
                <li><i class="nav_3"></i><a href="energyuse.html">用能分析</a> </li>


            </ul>
        </div>
        <div class="header_center left">
            <h2 style="height: 30%;"><strong>用能综合分析预警软件平台</strong></h2>
            <p class="color_font"><small>Comprehensive energy use analysis and early warning software platform</small></p>
        </div>
        <div class="right nav text_right">
            <ul> <li><i class="nav_7"></i><a href="compwarning.html">综合预警</a> </li>
                <li><i class="nav_8"></i><a href="Report.html">用户建议</a> </li>
                <li><i class="nav_4"></i><a href="CaseStorage.html">帮助与反馈</a></a> </li>
                <!-- <li><i class="nav_4"></i><a href="CaseStorage.html">数据管理</a></a> </li> -->
            </ul>
        </div>
    </header>
    <!-- <div class="headerLine left"></div> -->
    <!--内容部分-->
    <!-- < class="con left"> -->
        <!--选择时间-->
        <!-- <div class="static_top left"> -->
    

        <!-- <div class="staticTitle" style="position: absolute; top: 80px;">
            <i></i><span>燃气用量</span>
        </div> -->
        <!--数据总概-->
        <!-- <div id="tablediv" >
        <div id="table_1">
    
    <table class="table table-bordered" style="position: absolute;top: 120px;bottom: 50%;width: 100%;">
        <thead><tr>
            <th>时间</th>
            <th>采暖供水</th></th>
            <th>采暖回水</th></th>
            <th>瞬时流量</th></th>
            <th>燃气瞬时释放热量</th></th>
            <th>水吸收热量</th>
            <th>热占比</th>
        </tr></thead>
        <tbody id="mavenmoniTable"  style="font-size: 10px;">
        </tbody>
    </table>
    </div>
    </div> -->
       
<div class="mavenmoniback"  style="background: url(img/bg.jpg);position: absolute; top: 80px;height: 92%;width: 100%;">
    <div class="panel panel-default" style="position: absolute; top: 20%;
    top: 10px !important;
    left: 10%;
    overflow-x: none!important; 
    overflow-y: auto!important; 
    height: 50%!important; 
    width:80%!important;
    background-color: #000A37!important;
    border-width: 10px!important;
    border-color: white;">
    <div id="table_1"> 
        <!-- Default panel contents -->
        <div class="panel-heading" style="font-size: 20px;text-align: center;color: white;">锅炉检测表</div>
        <button type="button" id="myButton" data-loading-text="Loading..." class="btn btn-primary" style="position:absolute; left:75%; top: 1%; height: 50px; width: 200px; background-color: #000A37; border-color: white;border-width: 2px; " onclick="exchangeDataInfo()">
          <input type="file" onchange="importf(this)" style="font-size: 5px;" />
          <p id="excelContent" hidden></p>
          从Excel中导入
        </button>
      
        <!-- Table -->
        <table class="table" style="color: white;position: absolute;top: 10%;" data-search="true" data-show-refresh="true">

                <thead><tr>
                    <th>时间</th>
                    <th>采暖供水</th></th>
                    <th>采暖回水</th></th>
                    <th>瞬时流量</th></th>
                    <th>燃气瞬时释放热量</th></th>
                    <th>水吸收热量</th>
                    <th>热占比</th>
                </tr></thead>
                <tbody id="mavenmoniTable"  >
                </tbody>
            
        </table>
      </div>
    </div>
    </div>
    <!-- <div class="list-group" style="position: absolute; top: 100px; left: 90%; right: 100%;width:600px; height: 400px;">
        <button type="button" class="list-group-item" onclick="myFunction_1()">复位</button>
        <button type="button" class="list-group-item" onclick="addfunc_1()">下一个</button>
        <button type="button" class="list-group-item" onclick="decfunc_1()">上一个</button>
      </div> -->
      <div class="dropdown" style="position: absolute; top:10%;left:2%;height:10%">
        <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"  style="height: 30%; position: relative;">
          地点选择
          <span class="caret" ></span>

        </button>
        
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="position:absolute;top: 15%;left: 2%; height:70%">
          <li><a id="BQJmav" onclick="changeLocation('BQJmav')">北七家</a></li>
          <li><a id="XBWmav" onclick="changeLocation('XBWmav')" style="background: white;">西北旺</a></li>
          <li><a id="HSmav" onclick="changeLocation('HSmav')" style="background: white;">黄寺</a></li>
          <!-- <li role="separator" class="divider"></li>
          <li><a href="#">Separated link</a></li> -->
        </ul>
      </div>
      <div class="dropdown" style="position: absolute; top:30%;left:2%;height:10%" >
        <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="height: 30%; position: relative;">
          锅炉编号选择
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu2" style="position:absolute;top: 19%;left: 2%; height:70%">
          <li><a id="mav#1" onclick= "changeMave('mav#1')" >#1</a></li>
          <li><a id="mav#2" onclick= "changeMave('mav#2')" style="background: white;">#2</a></li>
          <li><a id="mav#3" onclick= "changeMave('mav#3')" style="background: white;">#3</a></li>
          <!-- <li role="separator" class="divider"></li>
          <li><a href="#">Separated link</a></li> -->
        </ul>
      </div>

      <div class="btn-group" role="group" aria-label="..." style="position: absolute;left: 2%;top:60%; height: 50px;">
        <button type="button" class="btn btn-default" onclick="changeMavData()">确认</button>
      </div>

      
      <div class = "mavenCharts_demo" style="position: absolute;height: 360px; width: 600px;top:57%;left:32%;background-color: #000A37;">
        <div class="btn-group" role="group" aria-label="..." style="position: absolute; top: 2px; left: 70%;width:250px; height: 30px; ">
            <button type="button" class="btn btn-default" onclick="myFunction_1()" style="background-color: #000A37!important ; color: white; height: 30px;font-size: 10px;">复位</button>
            <button type="button" class="btn btn-default" onclick="addfunc_1()"  style="background-color: #000A37!important ;color: white; height: 30px;font-size: 10px;">下一个</button>
            <button type="button" class="btn btn-default" onclick="decfunc_1()" style="background-color: #000A37!important ;color: white; height: 30px;font-size: 10px;">上一个</button>
          </div>
        <!-- <div class="dropdown" style="position: absolute; top: 100px; left: 90%; right: 100%;width:600px; height: 400px;">
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
            <button  id = "button_1" onclick="myFunction_1()" >复位</button>
            <button  onclick="addfunc_1()" >下一个</button>
            <button  onclick="decfunc_1()" >上一个</button>
            </div>
            </div> -->
       
            <div id= "mavenmonitor_1" style="position: absolute; top: 10%; left: 0px; right :40%;width:600px; height: 350px;background-color: rgba(0, 10, 55,0.2);"></div>
    </div>
    <div id = 'alert_info_mav' class = 'alert alert-danger' style="position: absolute; top: 97%;width: 100%; height: 3%;"></div>
    </div>
      
</div>



<script>
    var choiseChart =0;
    function myFunction_1(){
       choiseChart=0;
        //  console.log(choiseChart);
        // return choiseChart;
        mavenmonitorfunc();
    }
    function addfunc_1(){
        choiseChart++;
        if(choiseChart >= 6)
            choiseChart =5;
        
        //  console.log(choiseChart);
        // return choiseChart;
        mavenmonitorfunc();

    }
    function decfunc_1(){
        choiseChart--;
        if(choiseChart < 0)
            choiseChart = 0;
        //  console.log(choiseChart);
        // return choiseChart;
        mavenmonitorfunc();

    }
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>
<script src="./js/xlsx.full.min.js"></script>
<script src="js/jquery/jQuery-2.2.0.min.js"></script>
<script src="js/echarts-all.js"></script>
<script src="js/base.js"></script>
<script src="js/ajax.js"></script>

<!-- 表的插入函数 -->
<script src='js/mavenmonidata.js'></script>
<!-- 图的插入函数 -->
<script src='js/mavenmonitor.js'></script>

<!-- 更新函数 -->

<script src="js/mavenUpdate.js"></script>

<!-- 导入函数 -->
<script src="js/excelInsert.js"></script>

    <!-- <script>
        var wb;//读取完成的数据
    
        var rABS = false; //是否将文件读取为二进制字符串
    
    
        function importf(obj) {
    
            if(!obj.files) {
    
                return;
    
            }
    
            var f = obj.files[0];
    
            var reader = new FileReader();
    
            reader.onload = function(e) {
    
                var data = e.target.result;
    
                 if(rABS) {
    
                    wb = XLSX.read(btoa(fixdata(data)), {//手动转化
    
                        type: 'base64'
    
                    });
    
                    } else {
    
                    wb = XLSX.read(data, {
    
                    type: 'binary'
    
                    });
    
                    }
    
            /**
    
             * wb.SheetNames[0]是获取Sheets中第一个Sheet的名字
    
             * wb.Sheets[Sheet名]获取第一个Sheet的数据
    
             */
    
                var excelJson = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);
    
                console.log(excelJson);
                console.log(excelJson.length);
                console.log(excelJson[0]);
                  document.getElementById("excelContent").innerHTML= JSON.stringify( excelJson );
    
                 };
    
               if(rABS) {
    
                  reader.readAsArrayBuffer(f);
    
               } else {
    
                   reader.readAsBinaryString(f);
    
                  }
    
    }
    
    
    function fixdata(data) {
    
        var o = "",
    
            l = 0,
    
            w = 10240;
    
        for(; l < data.byteLength / w; ++l) o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w, l * w + w)));
    
        o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w)));
    
        return o;
    
    }
    
            </script> -->
<!-- <script src="js/static.js"></script> -->

</body>
</html>